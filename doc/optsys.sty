% NeedsTeXFormat{LaTeX2e}[1994/06/01]

\ProvidesPackage{optsys}[2020/04/11 v1.0 LaTeX package for optsys works]

%\Requirepackage{etoolbox}

\newif\if@optsys@economics
\newif\if@optsys@viability
\newif\if@optsys@colors
\newif\if@optsys@control

\@optsys@controltrue

\DeclareOption{economics}{\@optsys@economicstrue}
\DeclareOption{viability}{\@optsys@viabilitytrue}
\DeclareOption{colors}{\@optsys@colorstrue}
\DeclareOption{nocontrol}{\@optsys@controlfalse}
\ProcessOptions*\relax

% some helps 
% \providecommand can be used to define a command only if it does not already exists
% \long devant un def indique que l'on peut couper les arguments (passage a la ligne)
% \def variantes (\def \gdef \edef \xdef)
% \csdef le nom est donné par un csname (csdef csgdef csedef et csxdef)
% ont peut faire des \cslet ou des \letcs ou des \csletcs
% \csuse{<cs name>}args of csname
% https://www.dickimaw-books.com/latex
% \DeclareMathOperator{\cn}{code} <=>  \def\cn{\mathop{\mathrm{\mathcal{C}^{n}}}\nolimits}
% on rajoute nolimits si le mode \cn_{} ne doit pas mettre le subscript en dessous comme dans _inf

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% GENERAL MATHEMATICAL NOTATION
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%------------------------------------------------------------------
% Colors
% ------------------------------------------------------------------

\if@optsys@colors

\RequirePackage{color}
\newcommand{\noir}[1]{\textcolor{black}{#1}}
\newcommand{\noire}[1]{\textcolor{black}{#1}}
\newcommand{\rouge}[1]{\textcolor{red}{#1}}
\newcommand{\bleue}[1]{\textcolor{blue}{#1}}
\newcommand{\bleu}[1]{\textcolor{blue}{#1}}
\newcommand{\verte}[1]{\textcolor{green}{#1}}
\newcommand{\blanc}[1]{\textcolor{white}{#1}}
\fi

%------------------------------------------------------------------
% Delimiters 
% ------------------------------------------------------------------

\newcommand{\normdelim}[1]{\np{#1}}                         % utility Taille ``normal''
\newcommand{\bigdelim}[1]{\bp{#1}}                          % utility Taille ``big''
\newcommand{\Bigdelim}[1]{\Bp{#1}}                          % utility Taille ``Big''
\newcommand{\biggdelim}[1]{\bgp{#1}}                        % utility Taille ``bigg''
\newcommand{\Biggdelim}[1]{\Bgp{#1}}                        % utility Taille ``Bigg''
\newcommand{\vardelim}[1]{\left(#1\right)}                  % utility Taille ``variable''

\newcommand{\normdelims}[2]{\normdelim{#1\mid#2}}           % avec s\'{e}parateur Taille ``normal''
\newcommand{\bigdelims}[2]{\bigdelim{#1\ \big\vert\ #2}}        % avec s\'{e}parateur Taille ``big''
\newcommand{\Bigdelims}[2]{\Bigdelim{#1\ \Big\vert\ #2}}        % avec s\'{e}parateur Taille ``Big''
\newcommand{\biggdelims}[2]{\biggdelim{#1\ \bigg\vert\ #2}}     % avec s\'{e}parateur Taille ``bigg''
\newcommand{\Biggdelims}[2]{\Biggdelim{#1\ \Bigg\vert\ #2}}     % avec s\'{e}parateur Taille ``Bigg''
\newcommand{\vardelims}[2]{\vardelim{#1\mid#2}}             % avec s\'{e}parateur Taille ``variable''

% 1-ary delimiters with multiple sizes
% \multiops{name}{prefix}{left-sep}{right-sep}
% 

\newcommand{\multiops}[4]{%
  \def\tst{#2}
  \ifx\tst\empty
  \expandafter\newcommand\csname n#1\endcsname[1]{#3{##1}#4}%
  \expandafter\newcommand\csname b#1\endcsname[1]{\big#3{##1}\big#4}%
  \expandafter\newcommand\csname B#1\endcsname[1]{\Big#3{##1}\Big#4}%
  \expandafter\newcommand\csname bg#1\endcsname[1]{\bigg#3{##1}\bigg#4}%
  \expandafter\newcommand\csname Bg#1\endcsname[1]{\Bigg#3{##1}\Bigg#4}%
  \else
  \expandafter\newcommand\csname n#1\endcsname[2][]{#2_{##1}#3{##2}#4}%
  \expandafter\newcommand\csname b#1\endcsname[2][]{#2_{##1}\big#3{##2}\big#4}%
  \expandafter\newcommand\csname B#1\endcsname[2][]{#2_{##1}\Big#3{##2}\Big#4}%
  \expandafter\newcommand\csname bg#1\endcsname[2][]{#2_{##1}\bigg#3{##2}\bigg#4}%
  \expandafter\newcommand\csname Bg#1\endcsname[2][]{#2_{##1}\Bigg#3{##2}\Bigg#4}%
  \fi
}

\multiops{p}{}{(}{)}                                      % (x)                                
\multiops{c}{}{[}{]}                                      % [x]
\multiops{a}{}{\{}{\}}                                    % {x}

% delimiters with multiple sizes and scalable separator separator

\newcommand{\multiopsvert}[4]{%
  \def\tst{#2}
  \ifx\tst\empty
  \expandafter\newcommand\csname n#1\endcsname[2]{#3{##1\,\vert\,##2}#4}%
  \expandafter\newcommand\csname b#1\endcsname[2]{\big#3{##1\,\big\vert\,##2}\big#4}%
  \expandafter\newcommand\csname def#1\endcsname[2]{\big#3{##1\,\big\vert\,##2}\big#4}%
  \expandafter\newcommand\csname B#1\endcsname[2]{\Big#3{##1\,\Big\vert\,##2}\Big#4}%
  \expandafter\newcommand\csname bg#1\endcsname[2]{\bigg#3{##1\,\bigg\vert\,##2}\bigg#4}%
  \expandafter\newcommand\csname Bg#1\endcsname[2]{\Bigg#3{##1\,\Bigg\vert\,##2}\Bigg#4}%
  \else
  \expandafter\newcommand\csname n#1\endcsname[3][]{#2_{##1}#3{##2\,\vert\,##3}#4}%
  \expandafter\newcommand\csname b#1\endcsname[3][]{#2_{##1}\big#3{##2\,\big\vert\,##3}\big#4}%
  \expandafter\newcommand\csname def#1\endcsname[3][]{#2_{##1}\big#3{##2\,\big\vert\,##3}\big#4}%
  \expandafter\newcommand\csname B#1\endcsname[3][]{#2_{##1}\Big#3{##2\,\Big\vert\,##3}\Big#4}%
  \expandafter\newcommand\csname bg#1\endcsname[3][]{#2_{##1}\bigg#3{##2\,\bigg\vert\,##3}\bigg#4}%
  \expandafter\newcommand\csname Bg#1\endcsname[3][]{#2_{##1}\Bigg#3{##2\,\Bigg\vert\,##3}\Bigg#4}%
  \fi
}

% delimiters with multiple sizes and scalable separator separator

\newcommand{\multiopssep}[5]{%
  \expandafter\newcommand\csname n#1\endcsname[2]{#2#3{##1#4\,##2}#5}%
  \expandafter\newcommand\csname b#1\endcsname[2]{#2\big#3{##1#4\,##2}\big#5}%
  \expandafter\newcommand\csname def#1\endcsname[2]{#2\big#3{##1#4\,##2}\big#5}%
  \expandafter\newcommand\csname B#1\endcsname[2]{#2\Big#3{##1#4\,##2}\Big#5}%
  \expandafter\newcommand\csname bg#1\endcsname[2]{#2\bigg#3{##1\,#4##2}\bigg#5}%
  \expandafter\newcommand\csname Bg#1\endcsname[2]{#2\Bigg#3{##1\,#4##2}\Bigg#5}%
}

% sets at different sizes with braces i.e { .... | ....}
\multiopsvert{set}{}{\{}{\}}                              
% sets at different sizes with bracets i.e [ .... | ....]
\multiopsvert{setc}{}{[}{]}                               
% sets at different sizes with parenthesis i.e ( .... | ....)
\multiopsvert{setp}{}{(}{)}                               

% scalar products at different sizes 
\multiopssep{scal}{}{\langle}{,}{\rangle}                   % < ., .>

\newcommand{\sequence}[2]{\left\{#1\right\}_{#2}}           % Suite
\newcommand{\proscal}[2]{\left\langle#1,\:#2\right\rangle}  % Produit scalaire

\newcommand{\doublecrochet}[1]{\llbracket #1 \rrbracket}    %{[[#1]]}
\newcommand{\dc}[1]{[\![#1]\!]}                             % Double crochet

\newcommand{\multiseq}[3]{
  \expandafter\newcommand\csname n#1\endcsname[2]{{#2{##1}#3}_{##2}}
  \expandafter\newcommand\csname b#1\endcsname[2]{{\big#2{##1}\big#3}_{##2}}
  \expandafter\newcommand\csname def#1\endcsname[2]{{\big#2{##1}\big#3}_{##2}}
  \expandafter\newcommand\csname B#1\endcsname[2]{{\Big#2{##1}\Big#3}_{##2}}
  \expandafter\newcommand\csname bg#1\endcsname[2]{{\bigg#2{##1}\bigg#3}_{##2}}
  \expandafter\newcommand\csname Bg#1\endcsname[2]{{\Bigg#2{##1}\Bigg#3}_{##2}}
}

\multiseq{seqp}{(}{)}                                       % ()_{}
\multiseq{seqa}{\{}{\}}                                     % {}_{}

% some operators or mapping using multisized options

\multiops{abs}{}{\lvert}{\rvert}                            % |x|                                
\multiops{norm}{}{\lVert}{\rVert}                           % ||x||

%------------------------------------------------------------------
% Derivation and integration
% ------------------------------------------------------------------

\newcommand{\dd}{\,\mathrm{d}}                              % d de derivation
\newcommand{\dpp}[2]{\dd #1 (#2)}                           % dP(omega)
\newcommand{\gradi}[2][]{\nabla_{#1}#2}                     % Gradient partiel
\newcommand{\hessi}[1]{\nabla^{2}#1}                        % Hessien



%------------------------------------------------------------------
% Environments
% ------------------------------------------------------------------

\ifdefined\PETIT\else \newenvironment{PETIT}{\small }{\normalsize} \fi
\ifdefined\Petit\else \newenvironment{Petit}{\footnotesize }{\normalsize} \fi 
\ifdefined\petit\else \newenvironment{petit}{\tiny }{\normalsize} \fi 
\ifdefined\sketchofproof\else \newenvironment{sketchofproof}{\small{\bf Sketch of proof.}}
{\hfill$\Box$\normalsize\bigskip}  \fi 

\ifdefined\proof\else \newenvironment{proof}{\small{\bf Proof.}}{\hfill$\Box$\normalsize\bigskip} \fi



%------------------------------------------------------------------
% Functions and mappings 
% ------------------------------------------------------------------

\newcommand{\compo}{\mathop{\scriptstyle\circ}}             % Composition

\newcommand{\fcara}[1]{\chi_{{}_{#1}}} % Fonction caract\'{e}ristique
\newcommand{\fident}[1]{\mathrm{I}_{#1}}                    % Fonction identit\'{e}
\newcommand{\findi}[1]{\mathbf{1}_{#1}}                     % Fonction indicatrice

%
\newcommand{\depart}{a}
\newcommand{\arrivee}{b}
\newcommand{\Depart}{A}
\newcommand{\Arrivee}{B}
\newcommand{\DEPART}{\mathbb{A}}
\newcommand{\ARRIVEE}{\mathbb{B}}
%
\newcommand{\departter}{\arrivee}
\newcommand{\arriveeter}{c}
\newcommand{\Departter}{\Arrivee}
\newcommand{\Arriveeter}{C}
\newcommand{\DEPARTter}{\ARRIVEE}
\newcommand{\ARRIVEEter}{\mathbb{C}}

%
\newcommand{\fonctionun}{f} 
\newcommand{\fonctiondeux}{g} 
\newcommand{\fonctiontrois}{h} 
%
\newcommand{\fonctionuncertain}{h}
\newcommand{\fonctionuncertainbis}{l} 
%
\newcommand{\fonctiondepart}{f}
\newcommand{\fonctiondepartbis}{h}
\newcommand{\fonctiondepartter}{k}
\newcommand{\fonctionarrivee}{g}
\newcommand{\fonctionDepartArrivee}{f}
\newcommand{\fonctionArriveeDepart}{g}
%
\newcommand{\BigFonctionun}{F} 
\newcommand{\BigFonctiondeux}{G} 
\newcommand{\BigFonctiontrois}{H} 
%
\newcommand{\BigFonctionuncertain}{H}
\newcommand{\BigFonctionuncertainbis}{L} 
%
\newcommand{\BigFonctionDepartArrivee}{F}
\newcommand{\BigFonctionArriveeDepart}{G}

\newcommand{\identity}{I}
\newcommand{\injection}{\iota}
\newcommand{\projection}{\pi}
\newcommand{\1}{{\mathbf 1}}   % XXXXX


\newcommand{\dom}[1][]{%
  \def\tst{#1} \ifx\tst\empty {\mathrm{dom}} \else \mathrm{dom}{\left({#1}\right)}\fi}
\newcommand{\domain}{\mathrm{dom}}
\newcommand{\range}{\mathrm{range}}
\newcommand{\RANGE}{\mathrm{range}}
\newcommand{\nprange}[1]{\range\np{#1}}
\newcommand{\epigraph}{\mathrm{epi}}


\newcommand{\LevelSet}{\LevelSetUp}
\newcommand{\StrictLevelSet}{\StrictLevelSetUp}
\newcommand{\LevelCurve}{\LevelCurveUp}
%
\newcommand{\DownLevelSet}[2]{\na{#1_{\leq #2}}}
\newcommand{\DownStrictLevelSet}[2]{\na{#1_{< #2}}}
\newcommand{\DownLevelCurve}[2]{\na{#1_{= #2}}}
%
\newcommand{\MidLevelSet}[2]{\na{#1 \leq #2}}
\newcommand{\MidStrictLevelSet}[2]{\na{#1 < #2}}
\newcommand{\MidLevelCurve}[2]{\na{#1 = #2}}
%
\newcommand{\UpLevelSet}[2]{\na{#1^{\leq #2}}}
\newcommand{\UpStrictLevelSet}[2]{\na{#1^{< #2}}}
\newcommand{\UpLevelCurve}[2]{\na{#1^{= #2}}}
%
\newcommand{\LevelSetUp}[2]{#1^{\leq #2}}
\newcommand{\StrictLevelSetUp}[2]{#1^{< #2}}
\newcommand{\LevelCurveUp}[2]{#1^{= #2}}
%
\newcommand{\LevelSetDown}[2]{#1_{\leq #2}}
\newcommand{\StrictLevelSetDown}[2]{#1_{< #2}}
\newcommand{\LevelCurveDown}[2]{#1_{= #2}}
%
\newcommand{\SuppLevelSet}[2]{#1^{\subset #2}}
\newcommand{\SuppLevelCurve}[2]{#1^{= #2}}



%------------------------------------------------------------------
% Paragraphs
% ------------------------------------------------------------------

\ifdefined\subsubsubsection\else 
\newcommand{\subsubsubsection}[1]{\paragraph{#1.}}
\fi
\ifdefined\subsubsubsubsection\else
\newcommand{\subsubsubsubsection}[1]{\medskip\noindent\textit{#1}.}
\fi



%------------------------------------------------------------------
% Punctuation 
% ------------------------------------------------------------------

\newcommand{\eqsepv}{\; , \enspace}       
\newcommand{\eqfinv}{\; ,}                
\newcommand{\eqfinp}{\; .}                
\newcommand{\eqfinpv}{\; ;}               



%------------------------------------------------------------------
% Real and natural numbers
% ------------------------------------------------------------------

\newcommand{\ExtendedReals}{[-\infty,+\infty]}
\newcommand{\barRR}{\overline{\mathbb R}}
\newcommand{\bRR}{]-\infty,+\infty]} %{\RR \cup \{+\infty\}}
\newcommand{\interval}[2]{\np{{#1}\!:\!{#2}}}
\newcommand{\ClosedIntervalOpen}[2]{[#1,#2[}
\newcommand{\OpenIntervalClosed}[2]{]#1,#2]}
\newcommand{\OpenIntervalOpen}[2]{]#1,#2[}
\newcommand{\ClosedIntervalClosed}[2]{[#1,#2]}

\newcommand{\ic}[1]{\llbracket #1 \rrbracket}
\newcommand{\inic}[2]{=#1,\ldots,#2}

\newcommand{\sign}[1]{\mathrm{sign}\np{#1}}
\newcommand{\abs}[1]{\lvert#1\rvert}         % already given at all sizes with 
\newcommand{\dist}[2]{\mathrm{dist}_{#1}\left(#2\right)}
\newcommand{\distance}{d}
\newcommand{\module}[1]{\lvert#1\rvert}
\newcommand{\bmodule}[1]{\big\lvert#1\big\rvert}


%------------------------------------------------------------------
% Sets operations
% ------------------------------------------------------------------

\newcommand{\cardinality}[1]{{\lvert #1 \rvert}}
\newcommand{\bcardinality}[1]{{\big\lvert #1 \big\rvert}}
\newcommand{\cardinal}[1]{{\lvert #1 \rvert}}
\newcommand{\bcardinal}[1]{{\big\lvert #1 \big\rvert}}
\newcommand{\compl}{^{\mathrm{c}}}                          % Compl\'{e}mentarit\'{e}
\newcommand{\procar}{\prod}                                 % Produit cart\'{e}sien
\newcommand{\parts}[1]{2^{#1}}                              % Parties

%------------------------------------------------------------------
% Sets symbols 
% ------------------------------------------------------------------

\newcommand{\element}{d}
\newcommand{\Set}{D}
\newcommand{\SET}{{\mathbb D}}

\newcommand{\RR}{{\mathbb R}} %"ensemble des reels"   
\newcommand{\NN}{{\mathbb N}} %"ensemble des entiers naturels"  
\newcommand{\ZZ}{{\mathbb Z}} %"ensemble des entiers relatifs"  
\newcommand{\CC}{{\mathbb C}} 
\newcommand{\DD}{{\mathbb D}} 
\newcommand{\AAA}{{\mathbb A}} % et non pas \AA
\newcommand{\BB}{{\mathbb B}} 
\newcommand{\EE}{{\mathbb E}} %"symbole d'esperance mathematique"
\newcommand{\FF}{{\mathbb F}} %"symbole d'esperance mathematique"
\newcommand{\HH}{{\mathbb H}} %
\newcommand{\PP}{{\mathbb P}} %"symbole de probabilite"
\newcommand{\QQ}{{\mathbb Q}} %"symbole de probabilite"
\newcommand{\TT}{{\mathbb T}} 
\newcommand{\UU}{{\mathbb U}} 
\newcommand{\VV}{{\mathbb V}} 
\newcommand{\WW}{{\mathbb W}} 
\newcommand{\XX}{{\mathbb X}} 
\newcommand{\YY}{{\mathbb Y}} 



%------------------------------------------------------------------
% Spaces
% ------------------------------------------------------------------

\newcommand{\espace}[1]{\mathbb{#1}}                        % Espace de Hilbert
\newcommand{\espacea}[1]{\mathbb{#1}}                       % Espace d'arriv\'{e}e
\newcommand{\espacef}[1]{\mathcal{#1}}                      % Espace fonctionnel
\newcommand{\partset}[1]{\mathfrak{P}\left(#1\right)}       % Ensemble des partitions


%------------------------------------------------------------------
% Theorems 
% ------------------------------------------------------------------

\ifdefined\theorem\else \newtheorem{theorem}{Theorem}\fi 
\ifdefined\proposition\else \newtheorem{proposition}[theorem]{Proposition}\fi 
\ifdefined\definition\else \newtheorem{definition}[theorem]{Definition}\fi 
\ifdefined\lemma\else \newtheorem{lemma}[theorem]{Lemma}\fi 
\ifdefined\corollary\else \newtheorem{corollary}[theorem]{Corollary}\fi 
\ifdefined\remark\else \newtheorem{remark}[theorem]{Remark}\fi 
\ifdefined\assumption\else \newtheorem{assumption}{Assumption}\fi 
\ifdefined\example\else \newtheorem{example}[theorem]{Example}\fi


%------------------------------------------------------------------
% Miscellaneous
% ------------------------------------------------------------------

%\newcommand{\bar}{\overline}
\newcommand{\cd}{\!\cdot\!}
\newcommand{\ind}[1]{_{#1}}     % indice
\newcommand{\IND}[1]{(#1)}
\newcommand{\llower}{^{\flat}}
\newcommand{\lloweropt}{^{\flat,\star}}
\newcommand{\LOWupper}{_{\sharp}}
\newcommand{\LOWllower}{_{\flat}}
\newcommand{\doubletilde}[1]{\widetilde{#1}}
%\newcommand{\tilde}{\widetilde}
\newcommand{\upper}{^{\sharp}}

\newcommand{\wrt}{\text{w.r.t.}}                            % ``w.r.t.''
\newcommand{\IFF}{iff~}                                     % if and only if 
\newcommand{\mtext}[1]{\,\mbox{#1}\,} %text in maths
\newcommand{\ds}{\displaystyle}

\newcommand{\defegal}{=}
\newcommand{\derpar}[2]{\frac{\partial#1}{\partial#2}}      % D\'{e}riv\'{e}e partielle
\newcommand{\dertot}[2]{\frac{\mathrm{d}#1}{\mathrm{d}#2}}  % D\'{e}riv\'{e}e totale





%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% SPECIFIC MATHEMATICAL NOTATION (by alphabetical order)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%------------------------------------------------------------------
% Bioeconomics
% ------------------------------------------------------------------

\if@optsys@economics

%% Biological models 

\newcommand{\mortal}{\mu}
\newcommand{\fertility}{\gamma}
\newcommand{\biomass}{B}
\newcommand{\biology}{\mathtt{Biol}}

%% CO2

%\newcommand{\co2}{\textsc{co}$_2$}
%\newcommand{\CO2}{\textsc{co}$_2$}
\newcommand{\ghg}{\textsc{ghg}}
\newcommand{\BAU}{{\rm bau}}
\newcommand{\GWP}{\textsc{gwp}}
\newcommand{\growth}{g}
\newcommand{\Emissions}{\mathtt{Emiss}}
\newcommand{\Damage}{\mathtt{Damage}}

%% Bioeconomic models

\newcommand{\SY}{\mathop{\mathtt{Sust}}}
\newcommand{\MSY}{\textsc{msy}}
\newcommand{\MSE}{\textsc{mse}}
\newcommand{\PPE}{\textsc{ppe}}
\newcommand{\CPE}{\textsc{cpe}}

\newcommand{\Consumption}{\mathtt{Consum}}
\newcommand{\consumption}{C}
\newcommand{\Environment}{\mathtt{Envir}}
\newcommand{\environment}{E}

\newcommand{\effort}{E}
\newcommand{\Effort}{E}
\newcommand{\Catch}{\mathtt{Catch}}
\newcommand{\catch}{h}

%% Fisheries models

\newcommand{\mature}{\gamma}
%\newcommand{\weight}{\mu}
\newcommand{\abundance}{N}
\newcommand{\multiplier}{\lambda}
\newcommand{\exploitation}{F}
\newcommand{\mortality}{M}
\newcommand{\SSB}{\mathtt{SSB}}
\newcommand{\spr}{\mathtt{spr}}
%\newcommand{\benefit}{B}

% \newcommand{\spawning_stock_biomass}{{\sf SSB}} 
% \newcommand{\fishing_mortality}{{\sf F}} 
\newcommand{\stockrecruitment}{stock-recruitment} %{{\sf S-R}}
%\renewcommand{\varphi}{\mathtt{S/R}}
\newcommand{\SR}{\mathtt{S/R}}
%\renewcommand{\SR}{\mathop{\mathsf{S/R}}}

\newcommand{\ICES}{\textsc{ices}}
\newcommand{\ices}{{\sf ices}}

\newcommand{\rref}{\llim} %{{\sf ref}}
\newcommand{\Bref}{\Blim} %{B_{{\sf ref}}}
\newcommand{\Fref}{\Flim} %{F_{{\sf ref}}}
\newcommand{\pa}{{\sf pa}}
\newcommand{\Bpa}{B_{\pa}}
\newcommand{\Fpa}{F_{\pa}}
\newcommand{\llim}{{\sf lim}}
\newcommand{\Blim}{B_{\llim}}
\newcommand{\Flim}{F_{\llim}}
\newcommand{\PA}{{\sf PA}}
\newcommand{\LLIM}{\textsc{lim}}
\newcommand{\LPA}{\textsc{pa}}

\newcommand{\ypr}{{\sf ypr}}
\newcommand{\mmin}{{\sf min}}
\newcommand{\mmax}{{\sf max}}
\newcommand{\gm}{{\sf gm}}
\newcommand{\mean}{{\sf mean}}
\newcommand{\msy}{{\sf msy}}

\newcommand{\PVA}{\textsc{pva}}
\newcommand{\CVA}{\textsc{cva}}

\newcommand{\threshold}[1]{{\Violet #1}} 
\newcommand{\equil}{_{\textsc{e}}}

\fi


%------------------------------------------------------------------
% Control theory
% ------------------------------------------------------------------

\if@optsys@control
\newcommand{\control}{u}
\newcommand{\Control}{U} % {\uppercase{u}}}% \control}}}
\newcommand{\CONTROL}{{\mathbb{U}}}% \Control}} 

\newcommand{\state}{x}
\newcommand{\State}{X} % \uppercase{x}}
\newcommand{\STATE}{{\mathbb{X}}} % \State

\newcommand{\dualstate}{\state^{\sharp}}
\newcommand{\Dualstate}{\State^{\sharp}}
\newcommand{\DUALSTATE}{\STATE^{\sharp}}

\newcommand{\uncertain}{w}
\newcommand{\Uncertain}{W} % {\uppercase{w}}}
\newcommand{\UNCERTAIN}{{\mathbb{W}}} % \Uncertain
\newcommand{\uncertainbis}{\uncertain'}

\newcommand{\policy}{\lambda}
\newcommand{\Policy}{\Lambda}
\newcommand{\POLICY}{\Lambda}
\newcommand{\strategy}{\policy}
\newcommand{\STRATEGY}{\POLICY}

\newcommand{\dynamics}{f}
\newcommand{\Dynamics}[2]{f_{#1:#2}}
\newcommand{\tildeDynamics}[2]{\tilde{f}_{#1:#2}}

\newcommand{\horizon}{T}
\newcommand{\tinitial}{t_0}
\newcommand{\tinitialplusone}{\tinitial +1}
\newcommand{\tinitialplustwo}{\tinitial +2}
\newcommand{\tun}{r}
\newcommand{\tbis}{s}
\newcommand{\tter}{t}
\fi 



%------------------------------------------------------------------
% Conditional infimum
% ------------------------------------------------------------------

% \newcommand{\infimalpostcomposition}{epi-composition}
% \newcommand{\Infimalpostcomposition}{Epi-composition}
\newcommand{\infimalpostcomposition}{conditional infimum}
\newcommand{\Infimalpostcomposition}{Conditional infimum}
\newcommand{\InfimalPostComposition}[2]{\inf\bc{#2\mid#1}}
%\newcommand{\InfimalPostComposition}[2]{#1\rhd#2} %{\tilde{#1}\cd{#2}}
\newcommand{\InfInfimalPostComposition}[3]{\inf_{#3}\bp{\InfimalPostComposition{#1}{#2}}} 
%\newcommand{\InfInfimalPostcomposition}[3]{\inf_{#3}\bp{#1\rhd#2}} 

\newcommand{\conditionalinfimum}{\infimalpostcomposition}
\newcommand{\Conditionalinfimum}{\Infimalpostcomposition}
\newcommand{\ConditionalInfimum}{\InfimalPostComposition}
\newcommand{\ConditionalSupremum}[2]{\sup\bc{#2\mid#1}}

%
\newcommand{\InfCond}[2]{\inf\bsetc{#1}{#2}}
\newcommand{\nInfCond}[2]{\inf\nsetc{#1}{#2}}
\newcommand{\bInfCond}[2]{\inf\bsetc{#1}{#2}}
\newcommand{\BInfCond}[2]{\inf\Bsetc{#1}{#2}}
\newcommand{\bgInfCond}[2]{\inf\bgsetc{#1}{#2}}
\newcommand{\BgInfCond}[2]{\inf\Bgsetc{#1}{#2}}
\newcommand{\argminInfCond}[2]{\argmin\bsetc{#1}{#2}}
%
\newcommand{\SupCond}[2]{\sup\bsetc{#1}{#2}}
\newcommand{\nSupCond}[2]{\sup\nsetc{#1}{#2}}
\newcommand{\bSupCond}[2]{\sup\bsetc{#1}{#2}}
\newcommand{\BSupCond}[2]{\sup\Bsetc{#1}{#2}}
\newcommand{\bgSupCond}[2]{\sup\bgsetc{#1}{#2}}
\newcommand{\BgSupCond}[2]{\sup\Bgsetc{#1}{#2}}
\newcommand{\argmaxSupCond}[2]{\argmax\bsetc{#1}{#2}}

% ------------------------------------------------------------------
% Convex analysis 
% ------------------------------------------------------------------

\newcommand{\aff}{\mathop{\mathrm{aff}}}
\newcommand{\balancedhull}{\mathrm{bal}}
\newcommand{\barriercone}{\mathrm{bar}}
\newcommand{\closedspan}{\overline{\mathrm{span}}}
\newcommand{\co}{^{\mathrm{co}}}                            % Convexit\'{e}
\newcommand{\cone}[1]{#1}
\newcommand{\closedcone}{\overline{\mathrm{cone}}}
\newcommand{\Cone}{K}
\newcommand{\conj}{^{\star}}
\newcommand{\Convex}{C}
\newcommand{\conicalhull}{\mathrm{cone}}
\newcommand{\continuitypoints}{\mathrm{cont}}
\newcommand{\convexhull}{\mathrm{co}}
\newcommand{\conv}{\mathop{\mathrm{co}}}                    % Enveloppe convexe
\newcommand{\closedconvexhull}{\overline{\mathrm{co}}}      % Enveloppe convexe ferm\'{e}e
\newcommand{\convf}{\mathop{\overline{\mathrm{co}}}}        % Enveloppe convexe ferm\'{e}e
\newcommand{\DualCone}[1]{{#1}^{\oplus}} % Bauschke-Combettes notation, p.122 
\newcommand{\epi}{\mathop{\mathrm{epi}}}                    % ``epi''
\newcommand{\FACE}{F}
\newcommand{\infcv}{\mathop{\scriptstyle\Box}}              % Inf-convolution
\newcommand{\interior}{\mathop{\mathrm{int}}}
\newcommand{\linearspan}{\mathrm{span}}
\newcommand{\lsc}{\text{l.s.c.}}                            % ``l.s.c.''
\newcommand{\NORMAL}{N}
\newcommand{\NormalCone}{\mathcal{N}}
\newcommand{\pola}{^{\circ}}
\newcommand{\bipola}{^{\circ\circ}}
\newcommand{\PolarTransform}[2]{{#1}^{\textrm{\textcircled{\tiny $#2$}}}}
\newcommand{\biPolarTransform}[2]{{#1}^{\textrm{\textcircled{\tiny$#2$}}\textrm{\textcircled{\tiny$#2$}'}}}
\newcommand{\Polarity}[1]{{#1}^{\circ}} 
%\newcommand{\biPolarity}[1]{{#1}^{\circ\circ}}
\newcommand{\Polaritybi}[1]{\SFMbi{#1}{\circ}}
\newcommand{\biPolarity}[1]{{#1}^{\circ\circ}}
%\newcommand{\Polar}[1]{{#1}^{\circ}}  Command \Polar already defined.
\newcommand{\polar}{^{\circ}} 
\newcommand{\biPolarCone}[1]{{#1}^{\ominus\ominus}} % Bauschke-Combettes notation, p.122 (6.28)
\newcommand{\PolarCone}[1]{{#1}^{\ominus}} % Bauschke-Combettes notation, p.122 (6.28)
\newcommand{\polarcone}{^{\ominus}} % Bauschke-Combettes notation, p.122 (6.28)
\newcommand{\Polarcone}{\ominus} % Bauschke-Combettes notation, p.122 (6.28)
\newcommand{\biPolarSet}[1]{{#1}^{\odot\odot}} % Bauschke-Combettes notation, p.136 (7.7)
\newcommand{\PolarSet}[1]{{#1}^{\odot}} % Bauschke-Combettes notation, p.136 (7.7)
\newcommand{\polarset}{^{\odot}} % Bauschke-Combettes notation, p.136 (7.7)
\newcommand{\Polarset}{\odot} % Bauschke-Combettes notation, p.136 (7.7)
\newcommand{\positivehull}{\mathrm{pos}} %Rockafellar-Wets, p.99 (3(11))
\newcommand{\ri}{\mathrm{ri}}
\newcommand{\relint}{\mathop{\mathrm{ri}}}                  % Int\'{e}rieur relatif
\newcommand{\sri}{\mathrm{sri}}
\newcommand{\StrictEpigraph}{\mathrm{epi}^+ \!}                    % ``epi''
\newcommand{\TopologicalClosure}[1]{\overline{#1}}
\newcommand{\usc}{\text{u.s.c.}}                            % ``u.s.c.''
\newcommand{\udual}{^{\star}}                                % Dualit\'{e}

%
\newcommand{\HILBERT}{{\mathbb V}}
\newcommand{\Hilbert}{V}
\newcommand{\hilbert}{v}
%
\newcommand{\PRIMAL}{{\mathbb X}}
\newcommand{\Primal}{X}
\newcommand{\primal}{x}
\newcommand{\PrimalMapping}{P}
%
\newcommand{\DUAL}{{\mathbb Y}}
\newcommand{\Dual}{Y}
\newcommand{\dual}{y}
\newcommand{\DualMapping}{D}
% 
% \newcommand{\PRIMALBIS}{{\mathbb U}}
% \newcommand{\Primalbis}{U}
% \newcommand{\primalbis}{u}
\newcommand{\primalbis}{\primal'}
\newcommand{\Primalbis}{\Primal'}
\newcommand{\PRIMALBIS}{\PRIMAL'}
%
\newcommand{\primalter}{\primal''}
\newcommand{\Primalter}{\Primal''}
\newcommand{\PRIMALTER}{\PRIMAL''}
%
% \newcommand{\DUALBIS}{\mathbb V}
% \newcommand{\Dualbis}{V}
% \newcommand{\dualbis}{v}
\newcommand{\dualbis}{\dual'}
\newcommand{\Dualbis}{\Dual'}
\newcommand{\DUALBIS}{\DUAL'}
%
\newcommand{\dualter}{\dual''}
\newcommand{\Dualter}{\Dual''}
\newcommand{\DUALTER}{\DUAL''}
%
\newcommand{\bisprimal}{u}
\newcommand{\BisPrimal}{U}
\newcommand{\BISPRIMAL}{\mathbb{U}}
\newcommand{\bisPRIMAL}{\mathbb{U}}
%
\newcommand{\bisdual}{v}
\newcommand{\BisDual}{V}
\newcommand{\BISDUAL}{\mathbb{V}}
\newcommand{\bisDUAL}{\mathbb{V}}
%
\newcommand{\bisprimalbis}{\bisprimal'}
\newcommand{\bisprimalter}{\bisprimal''}
%
\newcommand{\bisdualbis}{\bisdual'}
\newcommand{\bisdualter}{\bisdual''}
%
\newcommand{\terprimal}{s}
\newcommand{\Terprimal}{s}
\newcommand{\TERPRIMAL}{\mathbb{S}}
%
\newcommand{\terdual}{t}
\newcommand{\Terdual}{t}
\newcommand{\TERDUAL}{\mathbb{T}}
%
\newcommand{\BIDUAL}{{\PRIMAL}^{\sharp\sharp}}
\newcommand{\bidual}{{\primal}^{\sharp\sharp}}
%
\newcommand{\fonctionprimal}{f} 
\newcommand{\fonctiondual}{g} 
\newcommand{\fonctionprimalbis}{h} 
\newcommand{\fonctiondualbis}{k} 
%
\newcommand{\BigFonctionprimal}{F} 
\newcommand{\BigFonctiondual}{G} 
\newcommand{\BigFonctionprimalbis}{H} 
\newcommand{\BigFonctiondualbis}{K} 
%
\newcommand{\fonctionbisprimal}{f} 
\newcommand{\fonctionbisdual}{g} 
\newcommand{\fonctionbisprimalbis}{h} 
\newcommand{\fonctionbisdualbis}{k} 
%
\newcommand{\BigFonctionbisprimal}{F} 
\newcommand{\BigFonctionbisdual}{G} 
\newcommand{\BigFonctionbisprimalbis}{H} 
\newcommand{\BigFonctionbisdualbis}{K} 


%------------------------------------------------------------------
% Correspondences and binary relations
% ------------------------------------------------------------------

%% Operations on relations 

\newcommand{\complementary}[1]{#1\compl}
\newcommand{\Complementary}[1]{#1^{\mathsf{c}}}
\newcommand{\npComplementary}[1]{\np{#1}^{\mathsf{c}}}
\newcommand{\bpComplementary}[1]{\bp{#1}^{\mathsf{c}}}
\newcommand{\Converse}[1]{#1^{-1}} %^{\star}}
\newcommand{\npConverse}[1]{\np{#1}^{-1}} %^{\star}}
\newcommand{\bpConverse}[1]{\bp{#1}^{-1}} %^{\star}}
\newcommand{\TransitiveClosure}[1]{#1^{+}}
\newcommand{\npTransitiveClosure}[1]{\np{#1}^{+}}
\newcommand{\bpTransitiveClosure}[1]{\bp{#1}^{+}}
\newcommand{\BpTransitiveClosure}[1]{\Bp{#1}^{+}}
\newcommand{\TransitiveReflexiveClosure}[1]{#1^{*}}
\newcommand{\npTransitiveReflexiveClosure}[1]{\np{#1}^{*}}
\newcommand{\bpTransitiveReflexiveClosure}[1]{\bp{#1}^{*}}
\newcommand{\TransitiveClosureConverse}[1]{#1^{\pm}} %^{+\star}}
\newcommand{\npTransitiveClosureConverse}[1]{\np{#1}^{\pm}} %^{+\star}}
\newcommand{\bpTransitiveClosureConverse}[1]{\bp{#1}^{\pm}} %^{+\star}}
\newcommand{\TransitiveReflexiveClosureConverse}[1]{#1^{-*}}
\newcommand{\npTransitiveReflexiveClosureConverse}[1]{\np{#1}^{-*}}
\newcommand{\bpTransitiveReflexiveClosureConverse}[1]{\bp{#1}^{-*}}

%% Relations and correspondences

\newcommand{\relation}{\mathfrak{R}}
\newcommand{\relationbis}{\mathfrak{S}}
\newcommand{\relationter}{\mathfrak{T}}
\newcommand{\correspondence}{\mathfrak{R}}
\newcommand{\correspondencebis}{\mathfrak{S}}
\newcommand{\correspondenceter}{\mathfrak{T}}

%------------------------------------------------------------------
% Couplings, conjugacies and dualities
% ------------------------------------------------------------------

\newcommand{\Duality}{{\cal D}}
\newcommand{\Dualitybis}{{\cal E}}
\newcommand{\generator}{G}
\newcommand{\Generator}[1]{\generator^{#1}}
\newcommand{\rprimal}{r}
\newcommand{\rdual}{s}
\newcommand{\rprimalbis}{\rprimal'}
\newcommand{\rdualbis}{\rdualbis'}

\newcommand{\coupling}{c}
\newcommand{\Coupling}[2]{\coupling\np{#1,#2}}
\newcommand{\bpCoupling}[2]{\coupling\bp{#1,#2}}
\newcommand{\Fenchelcoupling}{\star}
% \newcommand{\FenchelCoupling}{\proscal}
\newcommand{\FenchelCoupling}[2]{\left\langle#1,\:#2\right\rangle}  
\newcommand{\biscoupling}{d}
\newcommand{\bisCoupling}[2]{\biscoupling\np{#1,#2}}
\newcommand{\couplingbis}{d}
\newcommand{\Couplingbis}[2]{\couplingbis\np{#1,#2}}
\newcommand{\couplingter}{e}
\newcommand{\CAPRA}{\textsc{CAPRA}}
\newcommand{\Capra}{\textsc{Capra}}
\newcommand{\capra}{\textsc{capra}} 
\newcommand{\CouplingCapra}{\cent} 
\newcommand{\couplingCAPRA}{\cent} %{\lozenge} %{\complement}
\newcommand{\CapraDual}{Capra$_\star$} 
\newcommand{\CouplingCapraDual}{\CouplingCapra_\star} 

\newcommand{\LFM}[1]{#1^{\star}}
\newcommand{\LFMr}[1]{#1^{\star'}}
\newcommand{\LFMbi}[1]{#1^{\star\star'}}
\newcommand{\LFMrbi}[1]{#1^{\star'\star}}
\newcommand{\biLFM}[1]{#1^{\star\star}}
\newcommand{\minusLFM}[1]{#1^{(-\star)}}
\newcommand{\minusLFMr}[1]{#1^{(-\star)'}}
\newcommand{\minusLFMbi}[1]{#1^{(-\star)(-\star)'}}
%
\newcommand{\SFMnew}[2][\star]{#2^{#1}}
\newcommand{\SFMrnew}[2][\star]{#2^{{#1}'}}
\newcommand{\SFMbinew}[2][\star]{#2^{#1{#1}'}}
%
\newcommand{\SFM}[2]{#1^{#2}}
\newcommand{\SFMr}[2]{#1^{{#2}'}}
\newcommand{\SFMbi}[2]{#1^{#2{#2}'}}
\newcommand{\SFMrbi}[2]{#1^{{#2}'#2}}

% \newcommand{\subdifferential}[2]{\partial_{#1}\!{#2}}
\newcommand{\subdifferential}[2]{\partial_{#1}{#2}}
\newcommand{\Lowsubdifferential}[2]{\partial_{#1}{#2}}
\newcommand{\Midsubdifferential}[2]{\partial_{#1}^{#1}{#2}}
\newcommand{\Uppsubdifferential}[2]{\partial^{#1}{#2}}
\newcommand{\UniqueLowsubdifferential}[2]{\nabla_{#1}{#2}}
\newcommand{\UniqueMidsubdifferential}[2]{\nabla_{#1}^{#1}{#2}}
\newcommand{\UniqueUppsubdifferential}[2]{\nabla^{#1}{#2}}

\newcommand{\BregmanDivergence}[2]{D^{#1,#2}}
\newcommand{\BregmanDistance}[2]{D^{#1,#2}}
\newcommand{\BregmanDistanceTwo}[2]{D^{#1,#2}}
\newcommand{\BregmanDistanceThree}[3]{D^{#1,#2,#3}}
% \newcommand{\BregmanDivergence}[2]{D_{#1}^{#2}}
\newcommand{\BregmanFunction}{h}
\newcommand{\ProximalOperator}[3]{\mathrm{Prox}_{#1}^{#2,#3}}
\newcommand{\ProximalOperatorThree}[4]{\mathrm{Prox}_{#4}^{#1,#2,#3}}

%------------------------------------------------------------------
% Economics
% ------------------------------------------------------------------

\if@optsys@economics

%% Economic models 

\newcommand{\interest}{r_{e}} % interest rate
\newcommand{\discount}{(\frac{1}{1+\interest})}
\newcommand{\Discount}{\frac{1}{1+\interest}}
\newcommand{\DISCOUNT}{\delta}

%\newcommand{\certainty_equiv}{\widehat}

\newcommand{\demand}{d}
\newcommand{\Demand}{D}
\newcommand{\price}{p}
\newcommand{\Price}{P}
\newcommand{\rent}{\mathtt{Rent}}
\newcommand{\profit}{P}
\newcommand{\Production}{\mathtt{Yield}}
\newcommand{\production}{Y}
\newcommand{\quantity}{q}
\newcommand{\Quantity}{Q}

\newcommand{\utility}{L}
\newcommand{\util}{\utility}
\newcommand{\utilfin}{K}

\newcommand{\InstantaneousCost}{L}
\newcommand{\FinalCost}{K}

\newcommand{\cost}{c}
\newcommand{\Cost}{C} %{\mathtt{Cost}}
\newcommand{\Costfin}{\mathtt{CostFin}}
\newcommand{\CostFunction}{{\cal C}} 

\newcommand{\Payoff}{\mathtt{Payoff}}
\newcommand{\payoff}{\mathtt{Payoff}}
\newcommand{\reward}{\mathtt{Reward}}

%% Stock models

\newcommand{\stock}{S}
\newcommand{\volume}{\stock}
\newcommand{\turbined}{q}
\newcommand{\spilled}{r}
\newcommand{\inflow}{a}

\newcommand{\Stock}{S}
\newcommand{\Volume}{\stock}
\newcommand{\Turbined}{Q}
\newcommand{\Spilled}{R}
\newcommand{\Inflow}{A}

\newcommand{\purchasing}{c}
\newcommand{\shortage}{b}
\newcommand{\holding}{h}

\fi

%------------------------------------------------------------------
% Graphs
% ------------------------------------------------------------------

\newcommand{\graph}{\mathfrak{G}}
\newcommand{\GRAPH}{{\cal G}}
%
\newcommand{\node}{n}
\newcommand{\Node}{N}
\newcommand{\NODE}{{\cal N}}
\newcommand{\arc}{a}
\newcommand{\ARC}{{\cal A}}
\newcommand{\Ancestor}{{\cal A}}
\newcommand{\Children}{{\cal C}}
% 
\newcommand{\vertex}{v}
\newcommand{\vertexbis}{\vertex'}
\newcommand{\vertexter}{\vertex''}
\newcommand{\Vertex}{V}
\newcommand{\VERTEX}{{\cal V}}
\newcommand{\graphedge}{e}
\newcommand{\Edge}{E}
\newcommand{\EDGE}{{\cal E}}
%
\newcommand{\flownode}{f}
\newcommand{\FlowNode}{F}
\newcommand{\flowarc}{q}
\newcommand{\FlowArc}{Q}
%
\newcommand{\flowvertex}{f}
\newcommand{\FlowVertex}{F}
\newcommand{\flowedge}{q}
\newcommand{\FlowEdge}{Q}


%------------------------------------------------------------------
% Lattices
% ------------------------------------------------------------------

% \tiny, \scriptsize, \footnotesize, \small, \normalsize, \large, \Large, \LARGE, \huge, \Huge

\newcommand{\nwedge}{\mathop{\text{\normalsize $\wedge$}}}
\newcommand{\bwedge}{\mathop{\text{\large $\wedge$}}}
\newcommand{\Bwedge}{\mathop{\text{\Large $\wedge$}}}
\newcommand{\bgwedge}{\mathop{\text{\LARGE $\wedge$}}}
\newcommand{\Bgwedge}{\mathop{\text{\Huge $\wedge$}}}

\newcommand{\nvee}{\mathop{\text{\normalsize $\vee$}}}
\newcommand{\bvee}{\mathop{\text{\large $\vee$}}}
\newcommand{\Bvee}{\mathop{\text{\Large $\vee$}}}
\newcommand{\bgvee}{\mathop{\text{\LARGE $\vee$}}}
\newcommand{\Bgvee}{\mathop{\text{\Huge $\vee$}}}



%------------------------------------------------------------------
% Linear algebra
% ------------------------------------------------------------------

\newcommand{\matrice}{A}
\newcommand{\matricebis}{B}
\newcommand{\Matrix}{M}
\newcommand{\Matrixbis}{N}
\newcommand{\ortho}{^{\bot}}                                % Orthogonalit\'{e}
\newcommand{\projop}[1]{\mathrm{proj}_{#1}}  
\newcommand{\proj}[2]{\projop{#1}\left(#2\right)}
\newcommand{\Subspace}{\HILBERT} 
\newcommand{\transp}{^{\top}}                               % Transposition
\newcommand{\vecteur}{b}

%\newcommand{\SousEnsemble}{\Uncertain}
%\newcommand{\SUBSPACES}{{\cal L}}

%------------------------------------------------------------------
% Moreau additions
% ------------------------------------------------------------------

%% used to stack operators and adapt the stack position with a kern 

\def\stackops#1#2#3{%
  \mathrel{\vbox{\offinterlineskip\ialign{%
        \hfil##\hfil\cr
        $#1$\cr
        \noalign{\kern#3}
        $#2$\cr}}}}

%% dotminus:  {-}^{.}

\def\dotminus{\stackops{\cdot}{-}{-.8ex}}

%% minusdot: {-}_{.}

\def\minusdot{\stackops{\cdot}{-}{-1.8ex}}

%% plusdot: {+}_{.}

\def\plusdot{\stackops{\cdot}{+}{-2.5ex}}

%% dotplus existe déjà 

%% oplusdot {\oplus}_{.}

\def\oplusdot{\stackops{\cdot}{\oplus}{-2.5ex}}

%% dotoplus {\oplus}^{.}

\def\dotoplus{\stackops{\cdot}{\oplus}{-0.2ex}}

\newcommand{\LowPlus}{\plusdot}  
\newcommand{\UppPlus}{\dotplus}  
\newcommand{\LowMinus}{\minusdot}  
\newcommand{\UppMinus}{\dotminus}  
 

%------------------------------------------------------------------
% Multi-agents
% ------------------------------------------------------------------

\newcommand{\agent}{a}
\newcommand{\agentbis}{b}
\newcommand{\agentter}{c}
\newcommand{\agentcuarto}{d}
%\newcommand{\Agent}{A} % do not use (already exists below)
\newcommand{\AGENT}{\mathbb{A}}

\newcommand{\bgent}{b}
\newcommand{\Bgent}{B}
\newcommand{\BGENT}{\mathbb{B}}

\newcommand{\cgent}{c}
\newcommand{\Cgent}{C}
\newcommand{\CGENT}{\mathbb{C}}

\newcommand{\SubAgents}{B}
\newcommand{\SubAgentsTwo}{C}
\newcommand{\SubAgentsThree}{C'}

\newcommand{\NP}{N}
\newcommand{\player}{p}
\newcommand{\playerbis}{q}
\newcommand{\playerter}{r}
\newcommand{\Player}{{\cal P}}
\newcommand{\PLAYER}{P} % \uppercase{\player}}

\newcommand{\Principal}{\mathtt{Pr}}
\newcommand{\Agent}{\mathtt{Ag}}

%% Sets and fields 

\newcommand{\history}{h}
\newcommand{\History}{H} % \uppercase{\history}}
\newcommand{\HISTORY}{\mathbb{H}} % cannot use \History here

\newcommand{\Nature}{N}
\newcommand{\NatureField}{F}

\newcommand{\Decision}{D}
\newcommand{\Information}{I}

%% Relations 

\newcommand{\subsys}{\mathfrak{S}}
\newcommand{\preced}{\mathfrak{P}}
\newcommand{\memory}{\mathfrak{M}}
\newcommand{\decisionmemory}{{\mathfrak{D}}}
\newcommand{\order}{\mathfrak{O}}

% there is a pullback in fdsymbol
\ifdefined\pullback
\renewcommand{\pullback}[1]{\left(#1\right)_{\star}}
\else
\newcommand{\pullback}[1]{\left(#1\right)_{\star}}
\fi
\newcommand{\pushback}[1]{\left(#1\right)^{\star}}

\newcommand{\crochet}[1]{\left< #1 \right>_{\preced}}
\newcommand{\bracket}[1]{\left< #1 \right>_{\memory}} 

\newcommand{\plusfine}{\succeq}
\newcommand{\moinsfine}{\preceq}

%% Products of sets and fields 

\newcommand{\oproduit}[2]{#1 \otimes #2}
\newcommand{\produit}[2]{#1 \times #2}
\newcommand{\oproduct}[2]{#1 \otimes #2}
\newcommand{\product}[2]{#1 \times #2}
\newcommand{\oIproduct}[2]{#2 \otimes #1}
\newcommand{\Iproduct}[2]{#2 \times #1}
% \newcommand{\oproduct}[2]{#2 \otimes #1}
% \newcommand{\product}[2]{#2 \times #1}
\newcommand{\othreeproduct}[3]{#3 \otimes #2 \otimes #1}
\newcommand{\threeproduct}[3]{#3 \times #2 \times #1}
%
\newcommand{\couple}[2]{\np{#1,#2}}
\newcommand{\bigcouple}[2]{\big(#1,#2\big)}
\newcommand{\Bigcouple}[2]{\Big(#1,#2\Big)}
\newcommand{\bcouple}[2]{\Bp{#1,#2}}
\newcommand{\Bcouple}[2]{\Bp{#1,#2}}
%
\newcommand{\Icouple}[2]{\np{#2,#1}}
\newcommand{\bigIcouple}[2]{\big(#2,#1\big)}
\newcommand{\BigIcouple}[2]{\Big(#2,#1\Big)}
\newcommand{\bIcouple}[2]{\Bp{#2,#1}}
\newcommand{\BIcouple}[2]{\Bp{#2,#1}}
% \newcommand{\couple}[2]{\np{#2,#1}}
% \newcommand{\bigcouple}[2]{\big(#2,#1\big)}
% \newcommand{\Bigcouple}[2]{\Big(#2,#1\Big)}
% \newcommand{\bcouple}[2]{\Bp{#2,#1}}
% \newcommand{\Bcouple}[2]{\Bp{#2,#1}}
\newcommand{\triplet}[3]{\np{#3,#2,#1}}
\newcommand{\btriplet}[3]{\bp{#3,#2,#1}}
\newcommand{\Btriplet}[3]{\Bp{#3,#2,#1}}

% \renewcommand{\couple}[2]{\np{#1,#2}}
% \renewcommand{\bigcouple}[2]{\big(#1,#2\big)}
% \renewcommand{\Bigcouple}[2]{\Big(#1,#2\Big)}
% \renewcommand{\bcouple}[2]{\Bp{#1,#2}}
% \renewcommand{\Bcouple}[2]{\Bp{#1,#2}}
% \renewcommand{\triplet}[3]{\np{#1,#3,#2}}
% \renewcommand{\btriplet}[3]{\bp{#1,#3,#2}}
% \renewcommand{\Btriplet}[3]{\Bp{#1,#3,#2}}



%% solution map

\newcommand{\hatcontrol}{M} 
\newcommand{\solutionmap}{S} 
\newcommand{\SetValuedSolutionMap}{{\cal S}}
\newcommand{\SolutionMap}{S}
\newcommand{\SetValuedReducedSolutionMap}{{\cal M}}
\newcommand{\ReducedSolutionMap}{M}

%% strategies

\newcommand{\wstrategy}{\policy}
\newcommand{\WSTRATEGY}{\POLICY}

%------------------------------------------------------------------
% Norms (normes)
% ------------------------------------------------------------------

\newcommand{\norm}[1]{\left\lVert #1\right\rVert}
\newcommand{\sqnorm}[1]{{\norm{#1}}^{2}}
\newcommand{\EuclideanNorm}[1]{\norm{#1}_{2}}
\newcommand{\EuclidianNorm}[1]{\norm{#1}}
\newcommand{\Norm}[1]{\norm{#1}}
\newcommand{\NormDual}[1]{\Norm{#1}_\star} 

% utility
\newcommand{\triplicate}[2][-0.12em]{#2\hspace{#1}#2\hspace{#1}#2}
\newcommand{\GTripleNorm}[1]{%%
  \expandafter\newcommand\csname #1\endcsname[1]{\triplicate{\lvert}{##1}\triplicate{\rvert}}%
  \expandafter\newcommand\csname n#1\endcsname[1]{\triplicate{\lvert}{##1}\triplicate{\rvert}}%
  \expandafter\newcommand\csname b#1\endcsname[1]{\triplicate{\big\lvert}{##1}\triplicate{\big\rvert}}%
  \expandafter\newcommand\csname B#1\endcsname[1]{\triplicate{\Big\lvert}{##1}\triplicate{\Big\rvert}}%
  \expandafter\newcommand\csname bg#1\endcsname[1]{\triplicate{\bigg\lvert}{##1}\triplicate{\bigg\rvert}}%
  \expandafter\newcommand\csname Bg#1\endcsname[1]{\triplicate{\Bigg\lvert}{##1}\triplicate{\Bigg\rvert}}%
}
% utility
\newcommand{\GTripleNormDual}[1]{%%
  \expandafter\newcommand\csname #1\endcsname[1]{\triplicate{\lvert}{##1}\triplicate{\rvert}_\star}%
  \expandafter\newcommand\csname n#1\endcsname[1]{\triplicate{\lvert}{##1}\triplicate{\rvert}_\star}%
  \expandafter\newcommand\csname b#1\endcsname[1]{\triplicate{\big\lvert}{##1}\triplicate{\big\rvert}_\star}%
  \expandafter\newcommand\csname B#1\endcsname[1]{\triplicate{\Big\lvert}{##1}\triplicate{\Big\rvert}_\star}%
  \expandafter\newcommand\csname bg#1\endcsname[1]{\triplicate{\bigg\lvert}{##1}\triplicate{\bigg\rvert}_\star}%
  \expandafter\newcommand\csname Bg#1\endcsname[1]{\triplicate{\Bigg\lvert}{##1}\triplicate{\Bigg\rvert}_\star}%
}
% utility
\newcommand{\fourplicate}[2][-0.12em]{#2\hspace{#1}#2\hspace{#1}#2\hspace{#1}#2}
\newcommand{\GQuadrupleNorm}[1]{%
  \expandafter\newcommand\csname #1\endcsname[1]{\fourplicate{\lvert}{##1}\fourplicate{\rvert}}%
  \expandafter\newcommand\csname n#1\endcsname[1]{\fourplicate{\lvert}{##1}\fourplicate{\rvert}}%
  \expandafter\newcommand\csname b#1\endcsname[1]{\fourplicate{\big\lvert}{##1}\fourplicate{\big\rvert}}%
  \expandafter\newcommand\csname B#1\endcsname[1]{\fourplicate{\Big\lvert}{##1}\fourplicate{\Big\rvert}}%
  \expandafter\newcommand\csname bg#1\endcsname[1]{\fourplicate{\bigg\lvert}{##1}\fourplicate{\bigg\rvert}}%
  \expandafter\newcommand\csname Bg#1\endcsname[1]{\fourplicate{\Bigg\lvert}{##1}\fourplicate{\Bigg\rvert}}%
}
% <size>TripleNorm and <size>QuadrupleNorm
\GTripleNorm{TripleNorm}
\newcommand{\triplenorm}[1]{\TripleNorm{#1}}
%
\GTripleNormDual{TripleNormDual}
\newcommand{\triplenormdual}[1]{\TripleNormDual{#1}}
% 
\GQuadrupleNorm{QuadrupleNorm}
%
\newcommand{\QuadrupleNormDual}[1]{\QuadrupleNorm[\star]{#1}}
%
\newcommand{\MinkowskiGauge}[1]{m_{#1}}
%
\newcommand{\SymmetricGauge}[2]{{#2}_{(#1)}^{\mathrm{sgn}}}
\newcommand{\SymmetricGaugeNorm}[2]{\norm{#2}_{(#1)}^{\mathrm{sgn}}}
\newcommand{\SupportBall}[2]{{#2}_{(#1)}^{\mathrm{sn}}}
%
\newcommand{\TopNorm}[2]{{#1}_{(#2)}^{\mathrm{tn}}}
\newcommand{\TopDualNorm}[2]{{#1}_{\star,(#2)}^{\mathrm{tn}}}
\newcommand{\TopDualNormF}[2]{{#1}_{\star,[#2]}^{\mathrm{tn}}}
\newcommand{\SupportNorm}[2]{{#1}_{(#2)}^{\star \mathrm{sn}}}
\newcommand{\SupportDualNorm}[2]{{#1}_{\star,(#2)}^{\star \mathrm{sn}}}
\newcommand{\SupportDualNormF}[2]{{#1}_{\star,[#2]}^{\star \mathrm{sn}}}
\newcommand{\CoordinateNorm}[2]{{#1}_{(#2)}^{\mathrm{\FlatRR}}}
\newcommand{\CoordinateNormDual}[2]{{#1}_{(#2),\star}^{\mathrm{\FlatRR}}}
\newcommand{\CoordinateDualNorm}[2]{{#1}_{\star,(#2)}^{\mathrm{\FlatRR}}}
\newcommand{\CoordinateDualNormDual}[2]{{#1}_{\star,(#2),\star}^{\mathrm{\FlatRR}}}
%
\newcommand{\lptopnorm}[2]{top-($#1$,$#2$) norm}
\newcommand{\lpsupportnorm}[2]{($#1$,$#2$)-support norm}
\newcommand{\LpTopNorm}[3]{\Norm{#1}_{#2,#3}^{\mathrm{tn}}}
\newcommand{\LpSupportNorm}[3]{\Norm{#1}_{#2,#3}^{\mathrm{sn}}}
%
\newcommand{\StarSet}[1]{(\star,#1)}
\newcommand{\SetStar}[1]{(#1,\star)}
\newcommand{\FlatRR}{{\cal R}}
%
\newcommand{\sphere}{s}
\newcommand{\Sphere}{S}
\newcommand{\SPHERE}{{\mathbb S}}
\newcommand{\SPHEREDual}{{\SPHERE}_{\star}}
%
\newcommand{\FlatSPHERE}{{\cal S}} 
\newcommand{\FlatSPHEREDual}{{\FlatSPHERE}_{\star}} 
%
\newcommand{\BALL}{{\mathbb B}}
\newcommand{\BALLDual}{\BALL_{\star}}
%
\newcommand{\FlatBALL}{{\cal B}}
\newcommand{\FlatBALLDual}{{\FlatBAL}_{\star}}
%
\newcommand{\TripleNormSphere}{\SPHERE} 
\newcommand{\TripleNormDualSphere}{\SPHEREDual}
%
\newcommand{\QuadrupleNormSphere}{\SPHERE} 
\newcommand{\QuadrupleNormDualSphere}{\SPHEREDual}
%
\newcommand{\TripleNormBall}{\BALL} 
\newcommand{\TripleNormDualBall}{\BALLDual}
%
\newcommand{\QuadrupleNormBall}{\BALL} 
\newcommand{\QuadrupleNormDualBall}{\BALLDual}
%
\newcommand{\normalized}{n}

%------------------------------------------------------------------
% Optimization 
% ------------------------------------------------------------------

\newcommand{\ad}{^{\mathrm{ad}}}                            % Admissibilit\'{e}
\newcommand{\argmin}{\mathop{\arg\min}} 
\newcommand{\argmax}{\mathop{\arg\max}} 

\newcommand{\criterion}{j}                                  % Crit\`{e}re
\newcommand{\criterionnodot}{\jmath}                        % Crit\`{e}re
\newcommand{\Criterion}{J}                                  % Crit\`{e}re apres 
\newcommand{\CRITERION}{\tilde{\jmath}} 
   
\newcommand{\coutint}{L}                                    % Co\^{u}t int\'{e}gral
\newcommand{\coutfin}{K}                                    % Co\^{u}t final

\newcommand{\Max}{\max}
\newcommand{\MAX}{\max}
%\renewcommand{\sup}{\max}

\newcommand{\Min}{\min}
\newcommand{\MIN}{\min}
%\renewcommand{\inf}{\min}

\newcommand{\opt}{^{*}}        % optimal
%\newcommand{\opt}{^{\star}}        % optimal
\newcommand{\adm}{^{\mbox \rm ad}}      % admissible

\newcommand{\Regret}{r}                                     

\newcommand{\VALUE}{V}                                      
\newcommand{\Value}{V}
% do NOT use \value
%\newcommand{\VALUEFUNCTION}{V}                                      
\newcommand{\ValueFunction}{\upsilon}



\newcommand{\adjoint}{q}
%\newcommand{\AdjointState}{q}
\newcommand{\Hamiltonian}{{\cal H}}
\newcommand{\Lagrangian}{{\cal L}}


\newcommand{\decrule}{\mathtt{Pol}}
% \usepackage{euscript}
\newcommand{\feedback}[1]{\EuScript{#1}}
\newcommand{\feedbackset}{\EuScript{\Control}}






%------------------------------------------------------------------
% Probability
% ------------------------------------------------------------------

\newcommand{\borel}[1]{\tribu{B}_{#1}^{\mathrm{o}}}
%\newcommand{\conditionaly}[2]{\np{ \{#1\} \mid #2 }}
\newcommand{\conditionaly}[2]{\nc{ #1 \mid #2 }}
\newcommand{\bcconditionaly}[2]{\bc{ #1 \mid #2 }}
\newcommand{\Bcconditionaly}[2]{\Bc{ #1 \mid #2 }}
% \newcommand{\conditionalySet}[2]{\np{ #1 \mid #2 }}
\newcommand{\ConditionalySingleton}[2]{\np{ \{#1\} \mid #2 }}
\newcommand{\epro}{(\Omega,\trib,\prbt)}
\newcommand{\espe}{\mathbb{E}}                          % Espérance 
\newcommand{\esper}[1]{\espe\normdelim{#1}}
\newcommand{\expect}[1]{\espe_{#1}}
\newcommand{\filtration}[1]{\mathbb{#1}}                    % Filtration
\newcommand{\omeg}{\Omega}
\newcommand{\prbt}{\mathbb{P}}                 % proba  du triplet
\newcommand{\probability}{\nu}
\newcommand{\soustribu}{{\cal G}}
%\newcommand{\mathscr}{\EuScript}
\newcommand{\tribu}[1]{\EuScript{#1}}                   % Tribu
\newcommand{\trib}{{\cal F}}
%

%
%\makeatletter
\def\va@h^#1{\def\va@expo{#1}\@ifnextchar_\va@hu\va@a}
\def\va@u_#1{\def\va@index{#1}\@ifnextchar^\va@uh\va@a}
\def\va@hu_#1{\def\va@index{#1}\va@a}
\def\va@uh^#1{\def\va@expo{#1}\va@a}
\def\va@a{\boldsymbol{\va@arg^{\textstyle\text{\unboldmath$\scriptstyle\va@expo$}}_%
    {\textstyle\text{\unboldmath$\scriptstyle\va@index$}}}}
\def\vaC#1{\def\va@expo{}\def\va@index{}\def\va@arg{\uppercase{#1}}%
  \@ifnextchar^{\va@h}{\@ifnextchar_\va@u\va@a}}
%\makeatother

%
\newcommand{\va}[1]{\mathbf{#1}}
\newcommand{\VA}[1]{\left[\va{#1}\right]}
\newcommand{\RV}{\mathtt{RV}}
\newcommand{\Rv}{\mathtt{Rv}}

%
\newcommand{\cov}{\mathop{\mathsf{cov}}}
\newcommand{\dispersion}{\mathop{\mathsf{D}}}
\newcommand{\vari}{\mathop{\mathsf{var}}}

\DeclareMathOperator*{\esssup}{ess\,sup}
\DeclareMathOperator*{\essinf}{ess\,inf}

% \newcommand{\dpp}[2]{\dd #1 (#2)}                           % dP(omega)

% Available at multiple size

\multiops{prob}{{\PP}}{[}{]}                              % P[.]
\multiops{esp}{{\EE}}{[}{]}                               % E[.]
\multiopsvert{espc}{\EE}{[}{]}                            % E[.|.]
\multiopsvert{probc}{\PP}{\{}{\}}                         % E[.|.]

%------------------------------------------------------------------
% Sparsity
% ------------------------------------------------------------------

\newcommand{\lzero}{\ell_0}
\newcommand{\lzeropseudonorm}{$\ell_0$~pseudonorm}%{$l_0$~pseudonorm}
\newcommand{\pseudonormlzero}{pseudonorm~$\ell_0$}%{pseudonorm~$l_0$}

\newcommand{\SupportMapping}{\mathrm{supp}}
\newcommand{\Support}[1]{\SupportMapping\np{#1}}

\newcommand{\Vset}{\na{1,\ldots,d}}
\newcommand{\IndexSet}{V} 
\newcommand{\IndexSubset}{K}
\newcommand{\IndexSubsetLess}{J}
\newcommand{\IndexSubsetMore}{M}
\newcommand{\LocalIndex}{j}
\newcommand{\LocalIndexbis}{i}

%------------------------------------------------------------------
% Uncertainty 
% ------------------------------------------------------------------

\newcommand{\uncertainty}{\omega}
\newcommand{\Uncertainty}{\Omega}
\newcommand{\Om}{\Omega}
\newcommand{\om}{\omega}

\newcommand{\scenario}{s}
\newcommand{\Scenario}{S}
\newcommand{\SCENARIO}{\mathbb{S}}
\newcommand{\Scenarios}{\mathbb{S}}
\newcommand{\scenariobis}{s'}

\def\scheme{%
\pstree[treemode=R,levelsep=3cm,radius=2pt]{\Tc{2pt}}{%
\pstree{\TC*}{%
\pstree{\TC*}{\Tr{HHH} \Tr{HHC}}
\pstree{\TC*}{\Tr{HCH} \Tr{HCC}}}
\pstree{\TC*}{%
\pstree{\TC*}{\Tr{CHH} \Tr{CHC}}
\pstree{\TC*}{\Tr{CCH} \Tr{CCC}}}}
}

\newcommand{\iid}{\text{i.i.d.}}                            % ``i.i.d.''                                                
%\newcommand{\wrt}{\text{w.r.t.}}                            % ``w.r.t.''                                                
%\newcommand{\st}{\text{s.t.}}                            % ``s.t.''                                                     
\newcommand{\as}{\text{a.s.}}                               % ``a.s.''                                                  
\newcommand{\Pps}[1][]{%
  \def\tst{#1} \ifx\tst\empty {$\prbt$-\as} \else {$#1$-\as} \fi
}

\newcommand{\Qps}{\Pps[\QQ]}                       % ``Q-a.s.''                                                


%%%%% Grilles                                                                                                           

\newcommand{\grid}[1]{\boldsymbol{\lowercase{#1}}}          % Grille                                                    
\newcommand{\gridop}[1]{\mathfrak{#1}}                      % Operateur sur grille                                      


%------------------------------------------------------------------
% Viability 
% ------------------------------------------------------------------

\if@optsys@viability

\newcommand{\dec}{\BB} % contraintes_decision
\newcommand{\decset}[1]{\dec\big(#1,x(#1)\big)}
\newcommand{\obj}{\mathbb{D}}
\newcommand{\Uad}{{\cal U}^{\rm ad}} 
\newcommand{\XUad}{{\cal T}^{\rm ad}}
\newcommand{\sdo}{{\mathbb A}} % state domain
\newcommand{\target}{\sdo(\horizon)}

\newcommand{\Ut}{\dec\big(t,\state(t)\big)}
\newcommand{\Us}{\dec(s,\state(s))}
\newcommand{\Utx}{\dec(t,x)}
\newcommand{\Usx}{\dec(s,x)}
\newcommand{\Ux}[1]{\dec^{#1}(\state)}
\newcommand{\UT}[1]{\dec(t,#1)}

\newcommand{\viab}{\mathbb{V}{\rm iab}}
\newcommand{\inv}{{\rm Inv}}
\newcommand{\vviab}{\mbox{\tiny viab}}
\newcommand{\decviab}{\dec^{\vviab}} 

\fi


\endinput
